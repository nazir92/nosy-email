language: java 
dist: trusty
jdk: oraclejdk8


addons:
  sonarcloud:
    organization: "notification-system"
    token:
      secure: "hgNJeim7YJPbFT6CjrRWn4kddtPLpOzK+ghwn+ZuNpwlBm0gbRj29lKVdFJb+W2lOg4XgF/FGZe0BQpXYUBBGkw9Ik1AXqXO+tZV5wndbR0lQDiDbYlK8/6rsBRBb6iONKmpcV6cRX25IVEhP3hAh8T5QcREO7IwucIesk3oCO3S8ve0rHtfJYyI0wFZkvNA2Uh6+Cs2M2Hr2aKe9K0x7DLCpx4SoucLl4pfMWk6AJeHVXKe84oDLaILUbC1iRejb2pi0u/I2sGtV8ZIegeD73N+s7qzp7ybvbMEG/3Zm7mMjheYr/Lxqa9PoWyYFQvxvokhzXs/+CutEzOxbVNeSoNNFZksg20/jw4IV8JCLS154RvoBbuZvlKvocOjgTkiwFaHXzZgVs1mwOseqbYMN8V6hyZPcbNku8LjYGiHQomnSU1WxvqSR4f97a2ah3Lzw6pwPYsqbe17qwvUSHGZ6EH6SjbTylZ7jfmow5PKGK2M5FzpTe8oQ044PvGViASRkh/CZblS9IX1BGMiRJG4PiaEy0ZVW9P5GvC9vEh6i1YacQMuZ6ygl/5q6sk4ckgGJnAHtci9muyI0/HI9PFHW88eaqmZbyJciTrnS0YwMlvrvyte4BgzimpAuayvU9DTbQw1vCcYfoQMeCO3ClCHY3REpxXn3JTbopth0y/UVTE="


script:
  # JaCoCo is used to have code coverage, "-Pcoverage" activates the maven profile in the pom.xml
  - ./mvnw clean install -B
  - ./mvnw clean verify sonar:sonar -Pcoverage 

cache:
  directories:
    - '$HOME/.m2/repository'
    - '$HOME/.sonar/cache'
    
services:
  - docker

after_success:
   - docker login -u $DOCKER_USER -p $DOCKER_PASS
   - docker build -t $IMAGE_TAG .
   - docker push $IMAGE_TAG
