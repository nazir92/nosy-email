language: java 
dist: trusty
jdk: oraclejdk8


addons:
  sonarcloud:
    organization: "notification-system"
    token:
      secure: "bDx+xy43OhbRM/5pqWtg2PI52xCNc5Mgta63meQg84MdCa/JK+vWHmfsIpNhvxHp+WA6IT+28zu6m75crPpQY7lhOyn4exCImXlKcBu4pB6kBOOZECV9sczFWPfh1vZ+zxqrYibAXDazYh9HmD9cY0PZ0pQ92K+YI+XhOeS8YbdXs+p1t5eivjI5salgetWZeMPEdqnKdeDjx3CtAMhTwDuUeos3bNRFtwIIktWIG/CEssmWinXtvqa3FCVNZoG97lRdJY74x4je5jZKuwaND0DSqM0KrOzq3NyQXcuotZ6EGrzcCbLbPRn863mpW6gOhd5QbBe3jEq+UwMqz/fghDTbry7M3JRsNrW2iOXVoq/D9kE67+xhc1YEwAWabQIYOVex6v7BjxU9j7KsCemq3j3LXT5zBP9uBJUkdApZqIlpKnFtUooBjmst4UgE3z41SSQMvfpb9Rtyc1b2KS6Q6KWRtN1edclLWPwEEDKZa6K1vHAFPQkWEfGcbIBjjPze41Do6cetCExsa9U9Psh9qwzIZzGoPDpehbOWtnyZlPY/Bt9GJ0VjYPZrT6JgEcQMnraSoUWeEM4dkVU4cGrZtWPdAUSDA2OBG8McLII2yn4mZbUcEq0XigTpw7tYGdDOF4jRXA+nFIKv3gcAffIbFn8O2JlthaUeQcH4VV6XkZI="


script:
  # JaCoCo is used to have code coverage, "-Pcoverage" activates the maven profile in the pom.xml
  - ./mvnw clean install -B
  - ./mvnw clean verify sonar:sonar -Pcoverage 

cache:
  directories:
    - '$HOME/.m2/repository'
    - '$HOME/.sonar/cache'
    
services:
  - docker

after_success:
   - docker login -u $DOCKER_USER -p $DOCKER_PASS
   - docker build -t $IMAGE_TAG .
   - docker push $IMAGE_TAG
